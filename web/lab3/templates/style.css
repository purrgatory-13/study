@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap");

:root{
  --font-body: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
  --font-display: "Space Grotesk", "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;

  --text: #0b1220;
  --muted: #5b6473;

  --surface: rgba(255,255,255,0.76);
  --surface-strong: rgba(255,255,255,0.92);
  --border: rgba(15,23,42,0.10);

  --accent: #dc2626;
  --accent2: #ea580c;
  --accent3: #b91c1c;

  --ring: rgba(239,68,68,0.28);
  --shadow-lg: 0 34px 80px rgba(2,6,23,0.18);
  --shadow-md: 0 18px 40px rgba(2,6,23,0.12);
  --shadow-sm: 0 10px 24px rgba(2,6,23,0.08);
  --shadow-accent: 0 14px 28px rgba(220,38,38,0.22);
  --shadow-accent-hover: 0 18px 34px rgba(220,38,38,0.26);
  --shadow-accent-active: 0 12px 26px rgba(220,38,38,0.20);

  --radius: 22px;
  --radius-sm: 14px;

  /* canvas palette (read in plot.js) */
  --plot-area-fill: rgba(239,68,68,0.24);
  --plot-area-stroke: rgba(220,38,38,0.95);
  --plot-axis: rgba(15,23,42,0.70);
  --plot-hit: #22c55e;
  --plot-miss: #ef4444;
  --plot-point-stroke: rgba(15,23,42,0.85);
}

html{
  font-family: var(--font-body);
  color: var(--text);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transition: background-color 0.3s ease, color 0.3s ease;
}

html[data-theme="dark"]{
  color-scheme: dark;
  --text: #eef2ff;
  --muted: rgba(226,232,240,0.72);

  --surface: rgba(15,23,42,0.56);
  --surface-strong: rgba(15,23,42,0.74);
  --border: rgba(148,163,184,0.18);

  --accent: #6366f1;
  --accent2: #d946ef;
  --accent3: #06b6d4;

  --ring: rgba(129,140,248,0.32);
  --shadow-lg: 0 34px 90px rgba(0,0,0,0.46);
  --shadow-md: 0 18px 44px rgba(0,0,0,0.36);
  --shadow-sm: 0 10px 26px rgba(0,0,0,0.26);
  --shadow-accent: 0 14px 28px rgba(99,102,241,0.22);
  --shadow-accent-hover: 0 18px 34px rgba(99,102,241,0.26);
  --shadow-accent-active: 0 12px 26px rgba(99,102,241,0.20);

  --plot-area-fill: rgba(99,102,241,0.24);
  --plot-area-stroke: rgba(99,102,241,0.95);
  --plot-axis: rgba(226,232,240,0.72);
  --plot-point-stroke: rgba(226,232,240,0.9);
}

/* Анимация смены темы */
html.theme-changing,
html.theme-changing * {
  transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease !important;
}

.card, .theme-toggle, .pill {
  transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

a{ color: inherit; text-decoration: none; }

/* page container */
.page{
  max-width: 1180px;
  margin: 0 auto;
  padding: 28px 22px 70px;
  position: relative;
  animation: pageIn 0.55s ease both;
}

.page::before{
  content: "";
  position: absolute;
  inset: -70px 0 auto;
  height: 320px;
  background:
    radial-gradient(700px 360px at 10% 10%, rgba(220,38,38,0.22), transparent 70%),
    radial-gradient(560px 320px at 90% 20%, rgba(239,68,68,0.18), transparent 70%),
    radial-gradient(520px 300px at 40% 100%, rgba(234,88,12,0.14), transparent 70%);
  filter: blur(26px);
  z-index: -2;
}

html[data-theme="dark"] .page::before{
  background:
    radial-gradient(700px 360px at 10% 10%, rgba(99,102,241,0.22), transparent 70%),
    radial-gradient(560px 320px at 90% 20%, rgba(6,182,212,0.18), transparent 70%),
    radial-gradient(520px 300px at 40% 100%, rgba(217,70,239,0.14), transparent 70%);
}

.topbar{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
  padding: 18px 20px;
  margin-bottom: 22px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background: linear-gradient(135deg, var(--surface-strong), var(--surface));
  box-shadow: var(--shadow-md);
  backdrop-filter: blur(10px);
  position: relative;
  overflow: hidden;
}

.topbar::after{
  content: "";
  position: absolute;
  right: -80px;
  top: -90px;
  width: 220px;
  height: 220px;
  background: radial-gradient(circle, rgba(234,88,12,0.22), transparent 70%);
  transform: rotate(10deg);
  opacity: 0.9;
  pointer-events: none;
}

html[data-theme="dark"] .topbar::after{
  background: radial-gradient(circle, rgba(217,70,239,0.22), transparent 70%);
}

.brand{
  display: flex;
  align-items: center;
  gap: 14px;
  min-width: 0;
}

.logo{
  width: 44px;
  height: 44px;
  border-radius: 16px;
  display: grid;
  place-items: center;
  font-size: 20px;
  color: #fff;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  box-shadow: 0 12px 26px var(--shadow-accent);
  user-select: none;
}

.logo-img{
  width: 44px;
  height: 44px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  user-select: none;
  /* Фоновое изображение устанавливается через JavaScript в theme.js */
}

.brand-text{
  min-width: 0;
}

.brand-title{
  font-family: var(--font-display);
  font-weight: 700;
  letter-spacing: 0.1px;
  line-height: 1.1;
}

.brand-subtitle{
  color: var(--muted);
  font-size: 0.92rem;
  margin-top: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 520px;
}

.pill{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 7px 10px;
  border-radius: 999px;
  border: 1px solid rgba(99,102,241,0.18);
  background: rgba(99,102,241,0.12);
  font-size: 0.85rem;
  color: var(--text);
  white-space: nowrap;
}

.pill.pill-soft{
  border-color: rgba(148,163,184,0.18);
  background: rgba(148,163,184,0.14);
  color: var(--muted);
}

.topbar-right{
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.clock-wrap{
  text-align: right;
  display: grid;
  gap: 2px;
}

.clock-label{
  font-size: 0.74rem;
  color: var(--muted);
}

.clock{
  font-family: var(--font-display);
  font-weight: 700;
  color: var(--accent);
  letter-spacing: 0.2px;
}

.theme-toggle{
  width: 44px;
  height: 44px;
  border-radius: 16px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,0.55);
  color: var(--text);
  cursor: pointer;
  box-shadow: var(--shadow-sm);
  backdrop-filter: blur(12px);
  display: grid;
  place-items: center;
  transition: transform 0.18s ease, border-color 0.18s ease, box-shadow 0.18s ease;
}

html[data-theme="dark"] .theme-toggle{
  background: rgba(15,23,42,0.52);
}

.theme-toggle:hover{
  transform: translateY(-1px);
  border-color: rgba(99,102,241,0.35);
  box-shadow: 0 12px 28px rgba(99,102,241,0.18);
}

.theme-toggle:active{
  transform: translateY(0);
}

/* cards */
.card{
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 22px;
  margin-bottom: 18px;
  box-shadow: var(--shadow-sm);
  backdrop-filter: blur(10px);
  animation: riseIn 0.55s ease both;
}

.card h3{
  font-family: var(--font-display);
  margin: 0 0 14px;
  letter-spacing: 0.15px;
}

.card h3::after{
  content: "";
  display: block;
  width: 52px;
  height: 3px;
  margin-top: 9px;
  border-radius: 999px;
  background: linear-gradient(90deg, var(--accent), var(--accent3));
}

.lead{
  font-size: 1.04rem;
  color: var(--muted);
  margin: 10px 0 16px;
  max-width: 70ch;
}

.small{
  font-size: 0.92rem;
}

.muted{
  color: var(--muted);
}

.hero-grid{
  display: grid;
  grid-template-columns: minmax(320px, 1.2fr) minmax(280px, 0.8fr);
  gap: 22px;
}

.hero h1{
  margin: 4px 0 0;
  font-family: var(--font-display);
  font-size: clamp(1.55rem, 2.2vw, 2.2rem);
  letter-spacing: 0.2px;
  line-height: 1.15;
}

.feature-list{
  display: grid;
  gap: 10px;
  margin-top: 18px;
}

.feature{
  display: flex;
  align-items: center;
  gap: 10px;
  color: var(--muted);
}

.feature .dot{
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  box-shadow: 0 8px 16px rgba(99,102,241,0.22);
}

.hero-actions{
  margin-top: 18px;
}

/* app form layout */
.form-grid{
  display: grid;
  grid-template-columns: minmax(280px, 0.85fr) minmax(400px, 1.15fr);
  gap: 22px;
}

.field{
  display: grid;
  gap: 8px;
  margin-bottom: 14px;
}

.label{
  font-weight: 600;
  color: rgba(15,23,42,0.80);
}

html[data-theme="dark"] .label{
  color: rgba(226,232,240,0.86);
}

.controls{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(56px, 1fr));
  gap: 10px;
}

.hint{
  margin: 14px 0 0;
  font-size: 0.95rem;
  color: var(--muted);
}

.canvas-wrapper{
  text-align: center;
  position: relative;
}

.plot{
  display: flex;
  justify-content: center;
  padding: 16px;
  border-radius: var(--radius);
  background: linear-gradient(140deg, rgba(239,68,68,0.10), rgba(255,255,255,0.60));
  border: 1px dashed rgba(148,163,184,0.28);
}

html[data-theme="dark"] .plot{
  background: linear-gradient(140deg, rgba(99,102,241,0.12), rgba(15,23,42,0.38));
  border-color: rgba(148,163,184,0.22);
}

#plotCanvas{
  border: 1px solid rgba(148,163,184,0.28);
  background: rgba(255,255,255,0.96);
  border-radius: var(--radius-sm);
  box-shadow: 0 18px 38px rgba(2,6,23,0.14);
  max-width: 100%;
  height: auto;
}

html[data-theme="dark"] #plotCanvas{
  background: rgba(2,6,23,0.25);
  border-color: rgba(148,163,184,0.22);
}

/* badges */
.badge{
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  border-radius: 999px;
  font-size: 0.85rem;
  font-weight: 600;
  border: 1px solid transparent;
}

.badge.badge-ok{
  background: rgba(34,197,94,0.14);
  border-color: rgba(34,197,94,0.22);
  color: var(--text);
}

.badge.badge-bad{
  background: rgba(239,68,68,0.12);
  border-color: rgba(239,68,68,0.22);
  color: var(--text);
}

html[data-theme="dark"] .badge.badge-ok,
html[data-theme="dark"] .badge.badge-bad{
  color: var(--text);
}

.footer-note{
  margin-top: 18px;
  color: var(--muted);
  font-size: 0.92rem;
}

/* PrimeFaces overrides (PF8) */
.ui-inputfield,
.ui-inputtext,
.ui-selectonemenu{
  border-radius: var(--radius-sm) !important;
  border: 1px solid rgba(148,163,184,0.32) !important;
  background: rgba(255,255,255,0.86) !important;
  box-shadow: none !important;
}

html[data-theme="dark"] .ui-inputfield,
html[data-theme="dark"] .ui-inputtext,
html[data-theme="dark"] .ui-selectonemenu{
  border-color: rgba(148,163,184,0.24) !important;
  background: rgba(2,6,23,0.18) !important;
  color: var(--text) !important;
}

.ui-inputfield:focus,
.ui-inputtext:focus,
.ui-selectonemenu:focus{
  border-color: var(--accent) !important;
  box-shadow: 0 0 0 4px var(--ring) !important;
}

.ui-button{
  border-radius: var(--radius-sm) !important;
  background: linear-gradient(135deg, var(--accent), var(--accent2)) !important;
  border: none !important;
  box-shadow: var(--shadow-accent);
  transition: transform 0.18s ease, box-shadow 0.18s ease, filter 0.18s ease;
}

.ui-button:hover{
  filter: brightness(1.02);
  transform: translateY(-1px);
  box-shadow: var(--shadow-accent-hover);
}

.ui-button:active{
  transform: translateY(0);
  box-shadow: var(--shadow-accent-active);
}

.ui-button .ui-button-text{
  font-weight: 700;
  letter-spacing: 0.1px;
}

.ui-button.btn-ghost{
  background: transparent !important;
  border: 1px solid rgba(148,163,184,0.32) !important;
  color: var(--text) !important;
  box-shadow: none;
}

.ui-button.btn-ghost:hover{
  transform: translateY(-1px);
  border-color: var(--accent) !important;
  box-shadow: 0 10px 24px var(--ring);
}

.controls .ui-button.y-btn{
  background: rgba(148,163,184,0.14) !important;
  border: 1px solid rgba(148,163,184,0.24) !important;
  color: var(--text) !important;
  box-shadow: none;
}

.controls .ui-button.y-btn:hover{
  border-color: var(--accent) !important;
  background: var(--ring) !important;
}

.controls .ui-button.y-btn.is-active{
  background: linear-gradient(135deg, var(--accent), var(--accent2)) !important;
  border: none !important;
  color: #fff !important;
  box-shadow: var(--shadow-accent);
}

.ui-messages{
  border-radius: var(--radius-sm);
  overflow: hidden;
  border: 1px solid var(--border);
  box-shadow: var(--shadow-sm);
}


/* PrimeFaces DataTable + paginator (force our theme, even if PF theme loads after) */
.page .ui-datatable,
.page .ui-datatable .ui-datatable-tablewrapper,
.page .ui-datatable table{
  background: var(--surface-strong) !important;
  color: var(--text) !important;
}

.page .ui-datatable{
  border-radius: var(--radius);
  overflow: hidden;
  border: 1px solid var(--border) !important;
  box-shadow: var(--shadow-md);
}

.page .ui-datatable .ui-widget-content{
  background: transparent !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}

.page .ui-datatable thead th,
.page .ui-datatable thead th.ui-state-default{
  background: rgba(99,102,241,0.14) !important;
  color: var(--text) !important;
  font-weight: 700 !important;
  border-bottom: 1px solid rgba(148,163,184,0.22) !important;
}

html[data-theme="dark"] .page .ui-datatable thead th,
html[data-theme="dark"] .page .ui-datatable thead th.ui-state-default{
  background: rgba(99,102,241,0.16) !important;
}

.page .ui-datatable tbody td{
  background: transparent !important;
  color: var(--text) !important;
  border-color: rgba(148,163,184,0.18) !important;
}

.page .ui-datatable tbody tr{
  background: transparent !important;
}

.page .ui-datatable tbody tr:nth-child(even){
  background: rgba(148,163,184,0.06) !important;
}

html[data-theme="dark"] .page .ui-datatable tbody tr:nth-child(even){
  background: rgba(148,163,184,0.05) !important;
}

.page .ui-datatable tbody tr:hover{
  background: rgba(99,102,241,0.10) !important;
}

.page .ui-datatable .ui-sortable-column:not(.ui-state-active):hover{
  background: rgba(99,102,241,0.10) !important;
}

/* paginator */
.page .ui-paginator{
  border-top: 1px solid rgba(148,163,184,0.22) !important;
  background: rgba(255,255,255,0.35) !important;
}

html[data-theme="dark"] .page .ui-paginator{
  background: rgba(2,6,23,0.18) !important;
}

.page .ui-paginator .ui-paginator-page,
.page .ui-paginator .ui-paginator-next,
.page .ui-paginator .ui-paginator-prev,
.page .ui-paginator .ui-paginator-first,
.page .ui-paginator .ui-paginator-last{
  border-radius: 12px !important;
  border: 1px solid var(--border) !important;
  background: rgba(255,255,255,0.44) !important;
  color: var(--text) !important;
}

html[data-theme="dark"] .page .ui-paginator .ui-paginator-page,
html[data-theme="dark"] .page .ui-paginator .ui-paginator-next,
html[data-theme="dark"] .page .ui-paginator .ui-paginator-prev,
html[data-theme="dark"] .page .ui-paginator .ui-paginator-first,
html[data-theme="dark"] .page .ui-paginator .ui-paginator-last{
  background: rgba(2,6,23,0.26) !important;
}

.page .ui-paginator .ui-state-active{
  background: rgba(99,102,241,0.22) !important;
  border-color: rgba(99,102,241,0.45) !important;
}

/* animations */
@keyframes pageIn{
  from{ opacity: 0; transform: translateY(10px); }
  to{ opacity: 1; transform: translateY(0); }
}

@keyframes riseIn {
  from{ opacity: 0; transform: translateY(20px); }
  to{ opacity: 1; transform: translateY(0); }
}

/* Start page styles */
.start-page{
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  gap: 60px;
  position: relative;
}

.start-clock-container{
  text-align: center;
}

.start-clock{
  font-family: var(--font-display);
  font-size: clamp(4rem, 12vw, 8rem);
  font-weight: 700;
  letter-spacing: -0.02em;
  color: var(--text);
  text-shadow: 0 4px 20px rgba(0,0,0,0.1);
  display: block;
  line-height: 1;
}

html[data-theme="dark"] .start-clock{
  text-shadow: 0 4px 20px rgba(0,0,0,0.3);
}

.start-info-card{
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 40px 50px;
  box-shadow: var(--shadow-md);
  backdrop-filter: blur(10px);
  text-align: center;
  max-width: 600px;
  width: 100%;
  animation: riseIn 0.6s ease both;
}

.start-title{
  font-family: var(--font-display);
  font-size: clamp(2rem, 5vw, 3rem);
  font-weight: 700;
  margin: 0 0 30px;
  letter-spacing: 0.5px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.start-student-info{
  display: flex;
  flex-direction: column;
  gap: 16px;
  font-size: 1.1rem;
}

.start-info-row{
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 0;
  border-bottom: 1px solid var(--border);
}

.start-info-row:last-child{
  border-bottom: none;
}

.start-info-row strong{
  color: var(--text);
  font-weight: 600;
}

.start-info-row span{
  color: var(--muted);
}

.start-action{
  animation: riseIn 0.7s ease both;
}

.start-button{
  font-size: 1.4rem !important;
  padding: 20px 50px 20px 70px !important;
  font-weight: 700 !important;
  letter-spacing: 0.5px !important;
  min-width: 300px;
  position: relative !important;
}

.start-button .ui-button-icon-left,
.start-button .ui-button-icon-right{
  display: none !important;
}

.start-button::before{
  content: "";
  position: absolute;
  left: 20px;
  top: 50%;
  transform: translateY(-50%);
  width: 32px;
  height: 32px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  background-image: var(--start-button-logo, url(../resources/images/logo-light.png));
}

html[data-theme="dark"] .start-button::before{
  background-image: var(--start-button-logo, url(../resources/images/logo-dark.png));
}

.start-theme-toggle{
  position: fixed;
  top: 30px;
  right: 30px;
  z-index: 1000;
}

@keyframes riseIn{
  from{ opacity: 0; transform: translateY(14px); }
  to{ opacity: 1; transform: translateY(0); }
}

/* responsive */
@media (max-width: 1024px){
  .form-grid{ grid-template-columns: 1fr; }
  .hero-grid{ grid-template-columns: 1fr; }
  .brand-subtitle{ max-width: 360px; }
}

@media (max-width: 560px){
  .topbar{ padding: 16px; }
  .logo{ width: 40px; height: 40px; border-radius: 14px; }
  .page{ padding: 22px 14px 60px; }
}

/* ------------------------------------------------------------
   HARD OVERRIDES (PrimeFaces theme may load after our CSS)
   Boost specificity so dark mode never leaves the DataTable white.
------------------------------------------------------------- */
html[data-theme="dark"] body .page .ui-datatable,
html[data-theme="dark"] body .page .ui-datatable .ui-datatable-tablewrapper,
html[data-theme="dark"] body .page .ui-datatable table,
html[data-theme="dark"] body .page .ui-datatable .ui-datatable-data,
html[data-theme="dark"] body .page .ui-datatable .ui-widget-content{
  background: var(--surface-strong) !important;
  color: var(--text) !important;
}

html[data-theme="dark"] body .page .ui-datatable .ui-datatable-header,
html[data-theme="dark"] body .page .ui-datatable .ui-datatable-footer{
  background: rgba(2,6,23,0.18) !important;
  border-color: var(--border) !important;
  color: var(--text) !important;
}

html[data-theme="dark"] body .page .ui-datatable .ui-datatable-data > tr > td,
html[data-theme="dark"] body .page .ui-datatable tbody td{
  background: transparent !important;
  color: var(--text) !important;
  border-color: rgba(148,163,184,0.18) !important;
}

html[data-theme="dark"] body .page .ui-datatable .ui-datatable-data > tr:nth-child(even){
  background: rgba(148,163,184,0.05) !important;
}

html[data-theme="dark"] body .page .ui-datatable .ui-datatable-data > tr:hover{
  background: rgba(99,102,241,0.10) !important;
}

html[data-theme="dark"] body .page .ui-paginator{
  background: rgba(2,6,23,0.22) !important;
  border-color: rgba(148,163,184,0.18) !important;
}

html[data-theme="dark"] body .page .ui-paginator .ui-paginator-page,
html[data-theme="dark"] body .page .ui-paginator .ui-paginator-next,
html[data-theme="dark"] body .page .ui-paginator .ui-paginator-prev,
html[data-theme="dark"] body .page .ui-paginator .ui-paginator-first,
html[data-theme="dark"] body .page .ui-paginator .ui-paginator-last{
  background: rgba(2,6,23,0.30) !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}
